import socket
import struct

s = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.ntohs(3))

#s.bind(('', 0))

while True:
    pacote = s.recvfrom(50000)

    traduzido = struct.unpack('!BBHHHBBH4s4s', pacote[0][0:20])

    print 'From:', pacote[1][0]
    print 'Pacote: ', traduzido
    print 'IP Version: ', traduzido[0] >> 4
    print 'TTL:', traduzido[5]
    print 'Protocol:', traduzido[6]
    print 'Source IP:', socket.inet_ntoa(traduzido[8])
    print 'Source IP:', socket.inet_ntoa(traduzido[9])
    print pacote[0][20:]
